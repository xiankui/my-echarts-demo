/*from tccdn minify at 2017-4-18 10:29:35,fileï¼š/cn/v/2015/jqmodules/ztutils/iscroll/0.1.0/iscroll-probe.js*/
!function(k,c,j){function a(l,i){this.wrapper="string"==typeof l?c.querySelector(l):l,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var h in i){this.options[h]=i[h]}this.translateZ=this.options.HWCompositing&&b.hasPerspective?" translateZ(0)":"",this.options.useTransition=b.hasTransition&&this.options.useTransition,this.options.useTransform=b.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?b.ease[this.options.bounceEasing]||b.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function f(p,m,h){var l=c.createElement("div"),i=c.createElement("div");return h===!0&&(l.style.cssText="position:absolute;z-index:9999",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),i.className="iScrollIndicator","h"==p?(h===!0&&(l.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",i.style.height="100%"),l.className="iScrollHorizontalScrollbar"):(h===!0&&(l.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",i.style.width="100%"),l.className="iScrollVerticalScrollbar"),l.style.cssText+=";overflow:hidden",m||(l.style.pointerEvents="none"),l.appendChild(i),l}function d(l,h){this.wrapper="string"==typeof h.el?c.querySelector(h.el):h.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=l,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var i in h){this.options[i]=h[i]}this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(b.addEvent(this.indicator,"touchstart",this),b.addEvent(k,"touchend",this)),this.options.disablePointer||(b.addEvent(this.indicator,b.prefixPointerEvent("pointerdown"),this),b.addEvent(k,b.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(b.addEvent(this.indicator,"mousedown",this),b.addEvent(k,"mouseup",this))),this.options.fade&&(this.wrapperStyle[b.style.transform]=this.scroller.translateZ,this.wrapperStyle[b.style.transitionDuration]=b.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}var g=k.requestAnimationFrame||k.webkitRequestAnimationFrame||k.mozRequestAnimationFrame||k.oRequestAnimationFrame||k.msRequestAnimationFrame||function(e){k.setTimeout(e,1000/60)},b=function(){function i(e){return q===!1?!1:""===q?e:q+e.charAt(0).toUpperCase()+e.substr(1)}var p={},m=c.createElement("div").style,q=function(){for(var r,n=["t","webkitT","MozT","msT","OT"],o=0,h=n.length;h>o;o++){if(r=n[o]+"ransform",r in m){return n[o].substr(0,n[o].length-1)}}return !1}();p.getTime=Date.now||function(){return(new Date).getTime()},p.extend=function(n,e){for(var h in e){n[h]=e[h]}},p.addEvent=function(r,n,o,h){r.addEventListener(n,o,!!h)},p.removeEvent=function(r,n,o,h){r.removeEventListener(n,o,!!h)},p.prefixPointerEvent=function(e){return k.MSPointerEvent?"MSPointer"+e.charAt(9).toUpperCase()+e.substr(10):e},p.momentum=function(C,x,v,A,z,B){var w,s,y=C-x,u=j.abs(y)/v;return B=void 0===B?0.0006:B,w=C+u*u/(2*B)*(0>y?-1:1),s=u/B,A>w?(w=z?A-z/2.5*(u/8):A,y=j.abs(w-C),s=y/u):w>0&&(w=z?z/2.5*(u/8):0,y=j.abs(C)+w,s=y/u),{destination:j.round(w),duration:s}};var l=i("transform");return p.extend(p,{hasTransform:l!==!1,hasPerspective:i("perspective") in m,hasTouch:"ontouchstart" in k,hasPointer:k.PointerEvent||k.MSPointerEvent,hasTransition:i("transition") in m}),p.isBadAndroid=/Android /.test(k.navigator.appVersion)&&!/Chrome\/\d/.test(k.navigator.appVersion),p.extend(p.style={},{transform:l,transitionTimingFunction:i("transitionTimingFunction"),transitionDuration:i("transitionDuration"),transitionDelay:i("transitionDelay"),transformOrigin:i("transformOrigin")}),p.hasClass=function(n,e){var h=new RegExp("(^|\\s)"+e+"(\\s|$)");return h.test(n.className)},p.addClass=function(n,e){if(!p.hasClass(n,e)){var h=n.className.split(" ");h.push(e),n.className=h.join(" ")}},p.removeClass=function(n,e){if(p.hasClass(n,e)){var h=new RegExp("(^|\\s)"+e+"(\\s|$)","g");n.className=n.className.replace(h," ")}},p.offset=function(n){for(var e=-n.offsetLeft,h=-n.offsetTop;n=n.offsetParent;){e-=n.offsetLeft,h-=n.offsetTop}return{left:e,top:h}},p.preventDefaultException=function(n,e){for(var h in e){if(e[h].test(n[h])){return !0}}return !1},p.extend(p.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),p.extend(p.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return j.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(h){var e=4;return(h-=1)*h*((e+1)*h+e)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+0.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375}},elastic:{style:"",fn:function(o){var n=0.22,h=0.4;return 0===o?0:1==o?1:h*j.pow(2,-10*o)*j.sin((o-n/4)*(2*j.PI)/n)+1}}}),p.tap=function(o,n){var h=c.createEvent("Event");h.initEvent(n,!0,!0),h.pageX=o.pageX,h.pageY=o.pageY,o.target.dispatchEvent(h)},p.click=function(o){var n,h=o.target;/(SELECT|INPUT|TEXTAREA)/i.test(h.tagName)||(n=c.createEvent("MouseEvents"),n.initMouseEvent("click",!0,!0,o.view,1,h.screenX,h.screenY,h.clientX,h.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,0,null),n._constructed=!0,h.dispatchEvent(n))},p}();a.prototype={version:"5.1.3",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(m){if((1==b.eventType[m.type]||0===m.button)&&this.enabled&&(!this.initiated||b.eventType[m.type]===this.initiated)){!this.options.preventDefault||b.isBadAndroid||b.preventDefaultException(m.target,this.options.preventDefaultException)||m.preventDefault();var l,h=m.touches?m.touches[0]:m;this.initiated=b.eventType[m.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=b.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,l=this.getComputedPosition(),this._translate(j.round(l.x),j.round(l.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=h.pageX,this.pointY=h.pageY,this._execEvent("beforeScrollStart")}},_move:function(x){if(this.enabled&&b.eventType[x.type]===this.initiated){this.options.preventDefault&&x.preventDefault();var q,p,v,u,w=x.touches?x.touches[0]:x,h=w.pageX-this.pointX,s=w.pageY-this.pointY,m=b.getTime();if(this.pointX=w.pageX,this.pointY=w.pageY,this.distX+=h,this.distY+=s,v=j.abs(this.distX),u=j.abs(this.distY),!(m-this.endTime>300&&10>v&&10>u)){if(this.directionLocked||this.options.freeScroll||(v>u+this.options.directionLockThreshold?this.directionLocked="h":u>=v+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough){x.preventDefault()}else{if("horizontal"==this.options.eventPassthrough){return void (this.initiated=!1)}}s=0}else{if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough){x.preventDefault()}else{if("vertical"==this.options.eventPassthrough){return void (this.initiated=!1)}}h=0}}h=this.hasHorizontalScroll?h:0,s=this.hasVerticalScroll?s:0,q=this.x+h,p=this.y+s,(q>0||q<this.maxScrollX)&&(q=this.options.bounce?this.x+h/3:q>0?0:this.maxScrollX),(p>0||p<this.maxScrollY)&&(p=this.options.bounce?this.y+s/3:p>0?0:this.maxScrollY),this.directionX=h>0?-1:0>h?1:0,this.directionY=s>0?-1:0>s?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(q,p),m-this.startTime>300&&(this.startTime=m,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(A){if(this.enabled&&b.eventType[A.type]===this.initiated){this.options.preventDefault&&!b.preventDefaultException(A.target,this.options.preventDefaultException)&&A.preventDefault();var u,s,x=(A.changedTouches?A.changedTouches[0]:A,b.getTime()-this.startTime),w=j.round(this.x),z=j.round(this.y),h=j.abs(w-this.startX),v=j.abs(z-this.startY),m=0,y="";if(this.isInTransition=0,this.initiated=0,this.endTime=b.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(w,z),!this.moved){return this.options.tap&&b.tap(A,this.options.tap),this.options.click&&b.click(A),void this._execEvent("scrollCancel")}if(this._events.flick&&200>x&&100>h&&100>v){return void this._execEvent("flick")}if(this.options.momentum&&300>x&&(u=this.hasHorizontalScroll?b.momentum(this.x,this.startX,x,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:w,duration:0},s=this.hasVerticalScroll?b.momentum(this.y,this.startY,x,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:z,duration:0},w=u.destination,z=s.destination,m=j.max(u.duration,s.duration),this.isInTransition=1),this.options.snap){var q=this._nearestSnap(w,z);this.currentPage=q,m=this.options.snapSpeed||j.max(j.max(j.min(j.abs(w-q.x),1000),j.min(j.abs(z-q.y),1000)),300),w=q.x,z=q.y,this.directionX=0,this.directionY=0,y=this.options.bounceEasing}return w!=this.x||z!=this.y?((w>0||w<this.maxScrollX||z>0||z<this.maxScrollY)&&(y=b.ease.quadratic),void this.scrollTo(w,z,m,y)):void this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(l){var e=this.x,h=this.y;return l=l||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?h=0:this.y<this.maxScrollY&&(h=this.maxScrollY),e==this.x&&h==this.y?!1:(this.scrollTo(e,h,l,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=b.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(h,e){this._events[h]||(this._events[h]=[]),this._events[h].push(e)},off:function(l,e){if(this._events[l]){var h=this._events[l].indexOf(e);h>-1&&this._events[l].splice(h,1)}},_execEvent:function(l){if(this._events[l]){var e=0,h=this._events[l].length;if(h){for(;h>e;e++){this._events[l][e].apply(this,[].slice.call(arguments,1))}}}},scrollBy:function(n,l,m,h){n=this.x+n,l=this.y+l,m=m||0,this.scrollTo(n,l,m,h)},scrollTo:function(n,l,m,h){h=h||b.ease.circular,this.isInTransition=this.options.useTransition&&m>0,!m||this.options.useTransition&&h.style?(this._transitionTimingFunction(h.style),this._transitionTime(m),this._translate(n,l)):this._animate(n,l,m,h.fn)},scrollToElement:function(s,l,h,p,m){if(s=s.nodeType?s:this.scroller.querySelector(s)){var q=b.offset(s);q.left-=this.wrapperOffset.left,q.top-=this.wrapperOffset.top,h===!0&&(h=j.round(s.offsetWidth/2-this.wrapper.offsetWidth/2)),p===!0&&(p=j.round(s.offsetHeight/2-this.wrapper.offsetHeight/2)),q.left-=h||0,q.top-=p||0,q.left=q.left>0?0:q.left<this.maxScrollX?this.maxScrollX:q.left,q.top=q.top>0?0:q.top<this.maxScrollY?this.maxScrollY:q.top,l=void 0===l||null===l||"auto"===l?j.max(j.abs(this.x-q.left),j.abs(this.y-q.top)):l,this.scrollTo(q.left,q.top,l,m)}},_transitionTime:function(h){if(h=h||0,this.scrollerStyle[b.style.transitionDuration]=h+"ms",!h&&b.isBadAndroid&&(this.scrollerStyle[b.style.transitionDuration]="0.001s"),this.indicators){for(var e=this.indicators.length;e--;){this.indicators[e].transitionTime(h)}}},_transitionTimingFunction:function(h){if(this.scrollerStyle[b.style.transitionTimingFunction]=h,this.indicators){for(var e=this.indicators.length;e--;){this.indicators[e].transitionTimingFunction(h)}}},_translate:function(m,l){if(this.options.useTransform?this.scrollerStyle[b.style.transform]="translate("+m+"px,"+l+"px)"+this.translateZ:(m=j.round(m),l=j.round(l),this.scrollerStyle.left=m+"px",this.scrollerStyle.top=l+"px"),this.x=m,this.y=l,this.indicators){for(var h=this.indicators.length;h--;){this.indicators[h].updatePosition()}}},_initEvents:function(l){var m=l?b.removeEvent:b.addEvent,h=this.options.bindToWrapper?this.wrapper:k;m(k,"orientationchange",this),m(k,"resize",this),this.options.click&&m(this.wrapper,"click",this,!0),this.options.disableMouse||(m(this.wrapper,"mousedown",this),m(h,"mousemove",this),m(h,"mousecancel",this),m(h,"mouseup",this)),b.hasPointer&&!this.options.disablePointer&&(m(this.wrapper,b.prefixPointerEvent("pointerdown"),this),m(h,b.prefixPointerEvent("pointermove"),this),m(h,b.prefixPointerEvent("pointercancel"),this),m(h,b.prefixPointerEvent("pointerup"),this)),b.hasTouch&&!this.options.disableTouch&&(m(this.wrapper,"touchstart",this),m(h,"touchmove",this),m(h,"touchcancel",this),m(h,"touchend",this)),m(this.scroller,"transitionend",this),m(this.scroller,"webkitTransitionEnd",this),m(this.scroller,"oTransitionEnd",this),m(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var l,m,h=k.getComputedStyle(this.scroller,null);return this.options.useTransform?(h=h[b.style.transform].split(")")[0].split(", "),l=+(h[12]||h[4]),m=+(h[13]||h[5])):(l=+h.left.replace(/[^-\d.]/g,""),m=+h.top.replace(/[^-\d.]/g,"")),{x:l,y:m}},_initIndicators:function(){function u(h){for(var e=n.indicators.length;e--;){h.call(n.indicators[e])}}var o,q=this.options.interactiveScrollbars,m="string"!=typeof this.options.scrollbars,p=[],n=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(o={el:f("v",q,this.options.scrollbars),interactive:q,defaultScrollbars:!0,customStyle:m,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(o.el),p.push(o)),this.options.scrollX&&(o={el:f("h",q,this.options.scrollbars),interactive:q,defaultScrollbars:!0,customStyle:m,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(o.el),p.push(o))),this.options.indicators&&(p=p.concat(this.options.indicators));for(var l=p.length;l--;){this.indicators.push(new d(this,p[l]))}this.options.fadeScrollbars&&(this.on("scrollEnd",function(){u(function(){this.fade()})}),this.on("scrollCancel",function(){u(function(){this.fade()})}),this.on("scrollStart",function(){u(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){u(function(){this.fade(1,!0)})})),this.on("refresh",function(){u(function(){this.refresh()})}),this.on("destroy",function(){u(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){b.addEvent(this.wrapper,"wheel",this),b.addEvent(this.wrapper,"mousewheel",this),b.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){b.removeEvent(this.wrapper,"wheel",this),b.removeEvent(this.wrapper,"mousewheel",this),b.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(s){if(this.enabled){s.preventDefault(),s.stopPropagation();var l,h,p,m,q=this;if(void 0===this.wheelTimeout&&q._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){q._execEvent("scrollEnd"),q.wheelTimeout=void 0},400),"deltaX" in s){1===s.deltaMode?(l=-s.deltaX*this.options.mouseWheelSpeed,h=-s.deltaY*this.options.mouseWheelSpeed):(l=-s.deltaX,h=-s.deltaY)}else{if("wheelDeltaX" in s){l=s.wheelDeltaX/120*this.options.mouseWheelSpeed,h=s.wheelDeltaY/120*this.options.mouseWheelSpeed}else{if("wheelDelta" in s){l=h=s.wheelDelta/120*this.options.mouseWheelSpeed}else{if(!("detail" in s)){return}l=h=-s.detail/3*this.options.mouseWheelSpeed}}}if(l*=this.options.invertWheelDirection,h*=this.options.invertWheelDirection,this.hasVerticalScroll||(l=h,h=0),this.options.snap){return p=this.currentPage.pageX,m=this.currentPage.pageY,l>0?p--:0>l&&p++,h>0?m--:0>h&&m++,void this.goToPage(p,m)}p=this.x+j.round(this.hasHorizontalScroll?l:0),m=this.y+j.round(this.hasVerticalScroll?h:0),p>0?p=0:p<this.maxScrollX&&(p=this.maxScrollX),m>0?m=0:m<this.maxScrollY&&(m=this.maxScrollY),this.scrollTo(p,m,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var B,v,s,y,x,A,u=0,m=0,w=0,q=this.options.snapStepX||this.wrapperWidth,z=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0){for(s=j.round(q/2),y=j.round(z/2);w>-this.scrollerWidth;){for(this.pages[u]=[],B=0,x=0;x>-this.scrollerHeight;){this.pages[u][B]={x:j.max(w,this.maxScrollX),y:j.max(x,this.maxScrollY),width:q,height:z,cx:w-s,cy:x-y},x-=z,B++}w-=q,u++}}else{for(A=this.options.snap,B=A.length,v=-1;B>u;u++){(0===u||A[u].offsetLeft<=A[u-1].offsetLeft)&&(m=0,v++),this.pages[m]||(this.pages[m]=[]),w=j.max(-A[u].offsetLeft,this.maxScrollX),x=j.max(-A[u].offsetTop,this.maxScrollY),s=w-j.round(A[u].offsetWidth/2),y=x-j.round(A[u].offsetHeight/2),this.pages[m][v]={x:w,y:x,width:A[u].offsetWidth,height:A[u].offsetHeight,cx:s,cy:y},w>this.maxScrollX&&m++}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=j.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=j.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||j.max(j.max(j.min(j.abs(this.x-this.startX),1000),j.min(j.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(q,l){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var h=0,p=this.pages.length,m=0;if(j.abs(q-this.absStartX)<this.snapThresholdX&&j.abs(l-this.absStartY)<this.snapThresholdY){return this.currentPage}for(q>0?q=0:q<this.maxScrollX&&(q=this.maxScrollX),l>0?l=0:l<this.maxScrollY&&(l=this.maxScrollY);p>h;h++){if(q>=this.pages[h][0].cx){q=this.pages[h][0].x;break}}for(p=this.pages[h].length;p>m;m++){if(l>=this.pages[0][m].cy){l=this.pages[0][m].y;break}}return h==this.currentPage.pageX&&(h+=this.directionX,0>h?h=0:h>=this.pages.length&&(h=this.pages.length-1),q=this.pages[h][0].x),m==this.currentPage.pageY&&(m+=this.directionY,0>m?m=0:m>=this.pages[0].length&&(m=this.pages[0].length-1),l=this.pages[0][m].y),{x:q,y:l,pageX:h,pageY:m}},goToPage:function(s,l,h,p){p=p||this.options.bounceEasing,s>=this.pages.length?s=this.pages.length-1:0>s&&(s=0),l>=this.pages[s].length?l=this.pages[s].length-1:0>l&&(l=0);var m=this.pages[s][l].x,q=this.pages[s][l].y;h=void 0===h?this.options.snapSpeed||j.max(j.max(j.min(j.abs(m-this.x),1000),j.min(j.abs(q-this.y),1000)),300):h,this.currentPage={x:m,y:q,pageX:s,pageY:l},this.scrollTo(m,q,h,p)},next:function(n,l){var m=this.currentPage.pageX,h=this.currentPage.pageY;m++,m>=this.pages.length&&this.hasVerticalScroll&&(m=0,h++),this.goToPage(m,h,n,l)},prev:function(n,l){var m=this.currentPage.pageX,h=this.currentPage.pageY;m--,0>m&&this.hasVerticalScroll&&(m=0,h--),this.goToPage(m,h,n,l)},_initKeys:function(l){var m,h={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings){for(m in this.options.keyBindings){"string"==typeof this.options.keyBindings[m]&&(this.options.keyBindings[m]=this.options.keyBindings[m].toUpperCase().charCodeAt(0))}}else{this.options.keyBindings={}}for(m in h){this.options.keyBindings[m]=this.options.keyBindings[m]||h[m]}b.addEvent(k,"keydown",this),this.on("destroy",function(){b.removeEvent(k,"keydown",this)})},_key:function(w){if(this.enabled){var p,m=this.options.snap,u=m?this.currentPage.pageX:this.x,s=m?this.currentPage.pageY:this.y,v=b.getTime(),h=this.keyTime||0,q=0.25;switch(this.options.useTransition&&this.isInTransition&&(p=this.getComputedPosition(),this._translate(j.round(p.x),j.round(p.y)),this.isInTransition=!1),this.keyAcceleration=200>v-h?j.min(this.keyAcceleration+q,50):0,w.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?u+=m?1:this.wrapperWidth:s+=m?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?u-=m?1:this.wrapperWidth:s-=m?1:this.wrapperHeight;break;case this.options.keyBindings.end:u=m?this.pages.length-1:this.maxScrollX,s=m?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:u=0,s=0;break;case this.options.keyBindings.left:u+=m?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:s+=m?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:u-=m?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:s-=m?1:5+this.keyAcceleration>>0;break;default:return}if(m){return void this.goToPage(u,s)}u>0?(u=0,this.keyAcceleration=0):u<this.maxScrollX&&(u=this.maxScrollX,this.keyAcceleration=0),s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollY&&(s=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(u,s,0),this.keyTime=v}},_animate:function(z,r,y,q){function w(){var e,n,l,i=b.getTime();return i>=x?(v.isAnimating=!1,v._translate(z,r),void (v.resetPosition(v.options.bounceTime)||v._execEvent("scrollEnd"))):(i=(i-m)/y,l=q(i),e=(z-h)*l+h,n=(r-u)*l+u,v._translate(e,n),v.isAnimating&&g(w),void (3==v.options.probeType&&v._execEvent("scroll")))}var v=this,h=this.x,u=this.y,m=b.getTime(),x=m+y;this.isAnimating=!0,w()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},d.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(b.removeEvent(this.indicator,"touchstart",this),b.removeEvent(this.indicator,b.prefixPointerEvent("pointerdown"),this),b.removeEvent(this.indicator,"mousedown",this),b.removeEvent(k,"touchmove",this),b.removeEvent(k,b.prefixPointerEvent("pointermove"),this),b.removeEvent(k,"mousemove",this),b.removeEvent(k,"touchend",this),b.removeEvent(k,b.prefixPointerEvent("pointerup"),this),b.removeEvent(k,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var h=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=h.pageX,this.lastPointY=h.pageY,this.startTime=b.getTime(),this.options.disableTouch||b.addEvent(k,"touchmove",this),this.options.disablePointer||b.addEvent(k,b.prefixPointerEvent("pointermove"),this),this.options.disableMouse||b.addEvent(k,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(v){var l,u,h,p,m=v.touches?v.touches[0]:v,q=b.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,l=m.pageX-this.lastPointX,this.lastPointX=m.pageX,u=m.pageY-this.lastPointY,this.lastPointY=m.pageY,h=this.x+l,p=this.y+u,this._pos(h,p),1==this.scroller.options.probeType&&q-this.startTime>300?(this.startTime=q,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),v.preventDefault(),v.stopPropagation()},_end:function(l){if(this.initiated){if(this.initiated=!1,l.preventDefault(),l.stopPropagation(),b.removeEvent(k,"touchmove",this),b.removeEvent(k,b.prefixPointerEvent("pointermove"),this),b.removeEvent(k,"mousemove",this),this.scroller.options.snap){var h=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),m=this.options.snapSpeed||j.max(j.max(j.min(j.abs(this.scroller.x-h.x),1000),j.min(j.abs(this.scroller.y-h.y),1000)),300);(this.scroller.x!=h.x||this.scroller.y!=h.y)&&(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=h,this.scroller.scrollTo(h.x,h.y,m,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[b.style.transitionDuration]=e+"ms",!e&&b.isBadAndroid&&(this.indicatorStyle[b.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[b.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(b.addClass(this.wrapper,"iScrollBothScrollbars"),b.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(b.removeClass(this.wrapper,"iScrollBothScrollbars"),b.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=j.max(j.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=j.max(j.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var h=this.options.listenX&&j.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&j.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(h<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=j.max(this.indicatorWidth+h,8),this.indicatorStyle.width=this.width+"px"),h=this.minBoundaryX):h>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=j.max(this.indicatorWidth-(h-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",h=this.maxPosX+this.indicatorWidth-this.width):h=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),e<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=j.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=j.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=h,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[b.style.transform]="translate("+h+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=h+"px",this.indicatorStyle.top=e+"px")},_pos:function(h,e){0>h?h=0:h>this.maxPosX&&(h=this.maxPosX),0>e?e=0:e>this.maxPosY&&(e=this.maxPosY),h=this.options.listenX?j.round(h/this.sizeRatioX):this.scroller.x,e=this.options.listenY?j.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(h,e)},fade:function(n,l){if(!l||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var m=n?250:500,h=n?0:300;n=n?"1":"0",this.wrapperStyle[b.style.transitionDuration]=m+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,n),h)}}},a.utils=b,"undefined"!=typeof module&&module.exports?module.exports=a:k.IScroll=a}(window,document,Math);